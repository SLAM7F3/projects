<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CMT: xsens_time.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<div class="logo">
    <img src="LogoXsensMotion.gif" alt="Xsens Logo" style="float: right;" />
</div>

<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>xsens_time.h</h1><a href="xsens__time_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef _XSENS_TIME_2006_09_12</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define _XSENS_TIME_2006_09_12</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#ifndef _PSTDINT_H_INCLUDED</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span><span class="preprocessor">#       include "pstdint.h"</span>
<a name="l00006"></a>00006 <span class="preprocessor">#endif</span>
<a name="l00007"></a>00007 <span class="preprocessor"></span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;time.h&gt;</span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="keyword">namespace </span>xsens {
<a name="l00011"></a>00011 
<a name="l00013"></a><a class="code" href="xsens__time_8h.html#aed85698d4fabe8f04f5ba086741eb19">00013</a> <span class="preprocessor">#define XSENS_SEC_PER_DAY       (60*60*24)</span>
<a name="l00015"></a><a class="code" href="xsens__time_8h.html#7aac032491e970266165e373aebadf65">00015</a> <span class="preprocessor">#define XSENS_MS_PER_DAY        (XSENS_SEC_PER_DAY*1000)</span>
<a name="l00016"></a>00016 <span class="preprocessor"></span>
<a name="l00018"></a><a class="code" href="namespacexsens.html#a49366caee6fb9c9ff9721685bf0d30d">00018</a> <span class="keyword">typedef</span> uint64_t <a class="code" href="namespacexsens.html#a49366caee6fb9c9ff9721685bf0d30d">TimeStamp</a>;
<a name="l00019"></a>00019 
<a name="l00025"></a>00025 uint32_t <a class="code" href="namespacexsens.html#00d5dce92611428c34961bee5893155f">getTimeOfDay</a>(tm* date_ = NULL, time_t* secs_ = NULL);
<a name="l00026"></a>00026 
<a name="l00032"></a>00032 <span class="keywordtype">void</span> <a class="code" href="namespacexsens.html#a295555a3becd9dcbb25c451c24fa01a">msleep</a>(uint32_t ms);
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <a class="code" href="namespacexsens.html#a49366caee6fb9c9ff9721685bf0d30d">TimeStamp</a> <a class="code" href="namespacexsens.html#9a911c2e51e24b803f2ca465ad8a5bac">timeStampNow</a>(<span class="keywordtype">void</span>);
<a name="l00035"></a>00035 
<a name="l00036"></a><a class="code" href="classxsens_1_1_time_sync.html">00036</a> <span class="keyword">class </span><a class="code" href="classxsens_1_1_time_sync.html">TimeSync</a> {
<a name="l00037"></a>00037 <span class="keyword">private</span>:
<a name="l00038"></a><a class="code" href="classxsens_1_1_time_sync.html#d80a9f504fa16838aa34704cc8f1f037">00038</a>         <span class="keywordtype">int</span> <a class="code" href="classxsens_1_1_time_sync.html#d80a9f504fa16838aa34704cc8f1f037">m_timeSet</a>;
<a name="l00039"></a><a class="code" href="classxsens_1_1_time_sync.html#e4373fd8e87d0ceafea1b6e56de5954c">00039</a>         <span class="keywordtype">double</span> <a class="code" href="classxsens_1_1_time_sync.html#e4373fd8e87d0ceafea1b6e56de5954c">m_timeOffset</a>;    
<a name="l00040"></a><a class="code" href="classxsens_1_1_time_sync.html#63052a3a36320f83d586b5311929f5b0">00040</a>         <span class="keywordtype">double</span> <a class="code" href="classxsens_1_1_time_sync.html#63052a3a36320f83d586b5311929f5b0">m_tSyncPerSys</a>;   
<a name="l00041"></a><a class="code" href="classxsens_1_1_time_sync.html#b8b43bd7de30109e7e885eea4ccb3b74">00041</a>         int64_t <a class="code" href="classxsens_1_1_time_sync.html#b8b43bd7de30109e7e885eea4ccb3b74">m_tSysStart</a>;    
<a name="l00042"></a><a class="code" href="classxsens_1_1_time_sync.html#1d024a4f25e8c3818e95f42a41f55614">00042</a>         int64_t <a class="code" href="classxsens_1_1_time_sync.html#1d024a4f25e8c3818e95f42a41f55614">m_tSyncStart</a>;   
<a name="l00043"></a>00043 
<a name="l00044"></a><a class="code" href="classxsens_1_1_time_sync.html#e60d8ed3b5bb6faa318fb36a5a3d2701">00044</a>         int64_t <a class="code" href="classxsens_1_1_time_sync.html#e60d8ed3b5bb6faa318fb36a5a3d2701">m_tLastSysStart</a>;        
<a name="l00045"></a><a class="code" href="classxsens_1_1_time_sync.html#a2dad631fb0d38400101ee78e52e2ef8">00045</a>         int64_t <a class="code" href="classxsens_1_1_time_sync.html#a2dad631fb0d38400101ee78e52e2ef8">m_tLastSyncStart</a>;       
<a name="l00046"></a>00046 
<a name="l00047"></a><a class="code" href="classxsens_1_1_time_sync.html#86c98c41e922d06e3b8366f856f87bc9">00047</a>         <span class="keywordtype">double</span> <a class="code" href="classxsens_1_1_time_sync.html#86c98c41e922d06e3b8366f856f87bc9">m_dtSync</a>;
<a name="l00048"></a><a class="code" href="classxsens_1_1_time_sync.html#c0c75f6fbd98b2f2bd3ee9263d64c0de">00048</a>         <span class="keywordtype">double</span> <a class="code" href="classxsens_1_1_time_sync.html#c0c75f6fbd98b2f2bd3ee9263d64c0de">m_dtSys</a>;
<a name="l00049"></a>00049 
<a name="l00050"></a><a class="code" href="classxsens_1_1_time_sync.html#ecc34a026ce15b19feb1ede99fbab171">00050</a>         <span class="keywordtype">double</span> <a class="code" href="classxsens_1_1_time_sync.html#ecc34a026ce15b19feb1ede99fbab171">m_tolerance</a>;             
<a name="l00051"></a><a class="code" href="classxsens_1_1_time_sync.html#d343183e01ae6a8b1a16a792b09c0cdf">00051</a>         <span class="keywordtype">double</span> <a class="code" href="classxsens_1_1_time_sync.html#d343183e01ae6a8b1a16a792b09c0cdf">m_avgFactor</a>;             
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="keyword">public</span>:
<a name="l00054"></a><a class="code" href="classxsens_1_1_time_sync.html#350202ae2db7a4a6ce552f4acb32bcd2">00054</a>         <a class="code" href="classxsens_1_1_time_sync.html#350202ae2db7a4a6ce552f4acb32bcd2">TimeSync</a>(<span class="keywordtype">double</span> tolerance, <span class="keywordtype">double</span> factor) : <a class="code" href="classxsens_1_1_time_sync.html#d80a9f504fa16838aa34704cc8f1f037">m_timeSet</a>(0), <a class="code" href="classxsens_1_1_time_sync.html#ecc34a026ce15b19feb1ede99fbab171">m_tolerance</a>(tolerance), <a class="code" href="classxsens_1_1_time_sync.html#d343183e01ae6a8b1a16a792b09c0cdf">m_avgFactor</a>(factor) { }
<a name="l00055"></a>00055 
<a name="l00056"></a><a class="code" href="classxsens_1_1_time_sync.html#5c0d6f75cff1ff478b970ad7006d90b1">00056</a>         <span class="keywordtype">bool</span> <a class="code" href="classxsens_1_1_time_sync.html#5c0d6f75cff1ff478b970ad7006d90b1">isSet</a>(<span class="keywordtype">void</span>) { <span class="keywordflow">return</span> <a class="code" href="classxsens_1_1_time_sync.html#d80a9f504fa16838aa34704cc8f1f037">m_timeSet</a> != 0; }
<a name="l00057"></a><a class="code" href="classxsens_1_1_time_sync.html#ec514ae363cedb1000c0c8d2d0921810">00057</a>         <span class="keywordtype">void</span> <a class="code" href="classxsens_1_1_time_sync.html#ec514ae363cedb1000c0c8d2d0921810">reset</a>(<span class="keywordtype">void</span>) { <a class="code" href="classxsens_1_1_time_sync.html#d80a9f504fa16838aa34704cc8f1f037">m_timeSet</a> = 0; }
<a name="l00058"></a>00058         <span class="keywordtype">void</span> <a class="code" href="classxsens_1_1_time_sync.html#37743670b997126e1e46406bdbc5ffc4">setCurrentTime</a>(<a class="code" href="namespacexsens.html#a49366caee6fb9c9ff9721685bf0d30d">TimeStamp</a> syncTime, <a class="code" href="namespacexsens.html#a49366caee6fb9c9ff9721685bf0d30d">TimeStamp</a> receiveTime);
<a name="l00059"></a><a class="code" href="classxsens_1_1_time_sync.html#75641a2c96d248275bc9a09ac23e318e">00059</a>         <span class="keywordtype">double</span> <a class="code" href="classxsens_1_1_time_sync.html#75641a2c96d248275bc9a09ac23e318e">getOffset</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classxsens_1_1_time_sync.html#e4373fd8e87d0ceafea1b6e56de5954c">m_timeOffset</a>; }
<a name="l00060"></a><a class="code" href="classxsens_1_1_time_sync.html#4cae7157a3b858798a583435c41290a9">00060</a>         <span class="keywordtype">double</span> <a class="code" href="classxsens_1_1_time_sync.html#4cae7157a3b858798a583435c41290a9">getDrift</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classxsens_1_1_time_sync.html#63052a3a36320f83d586b5311929f5b0">m_tSyncPerSys</a>; }
<a name="l00061"></a>00061 
<a name="l00062"></a><a class="code" href="classxsens_1_1_time_sync.html#7dc3dc224df2a5edca78bfc7b547bf43">00062</a>         <a class="code" href="namespacexsens.html#a49366caee6fb9c9ff9721685bf0d30d">TimeStamp</a> <a class="code" href="classxsens_1_1_time_sync.html#7dc3dc224df2a5edca78bfc7b547bf43">getCurrentTime</a>(int64_t ts) { <span class="keywordflow">if</span> (<a class="code" href="classxsens_1_1_time_sync.html#d80a9f504fa16838aa34704cc8f1f037">m_timeSet</a>) <span class="keywordflow">return</span> <a class="code" href="classxsens_1_1_time_sync.html#1d024a4f25e8c3818e95f42a41f55614">m_tSyncStart</a>+int64_t(<span class="keywordtype">double</span>(ts-<a class="code" href="classxsens_1_1_time_sync.html#b8b43bd7de30109e7e885eea4ccb3b74">m_tSysStart</a>)*<a class="code" href="classxsens_1_1_time_sync.html#63052a3a36320f83d586b5311929f5b0">m_tSyncPerSys</a>); <span class="keywordflow">else</span> <span class="keywordflow">return</span> ts; }
<a name="l00063"></a><a class="code" href="classxsens_1_1_time_sync.html#6b29adcc8ec34e86d7db1c1106a1ad54">00063</a>         <a class="code" href="namespacexsens.html#a49366caee6fb9c9ff9721685bf0d30d">TimeStamp</a> <a class="code" href="classxsens_1_1_time_sync.html#6b29adcc8ec34e86d7db1c1106a1ad54">getInverseTime</a>(int64_t ts) { <span class="keywordflow">if</span> (<a class="code" href="classxsens_1_1_time_sync.html#d80a9f504fa16838aa34704cc8f1f037">m_timeSet</a>) <span class="keywordflow">return</span> <a class="code" href="classxsens_1_1_time_sync.html#b8b43bd7de30109e7e885eea4ccb3b74">m_tSysStart</a>+int64_t(<span class="keywordtype">double</span>(ts-<a class="code" href="classxsens_1_1_time_sync.html#1d024a4f25e8c3818e95f42a41f55614">m_tSyncStart</a>)/<a class="code" href="classxsens_1_1_time_sync.html#63052a3a36320f83d586b5311929f5b0">m_tSyncPerSys</a>); <span class="keywordflow">else</span> <span class="keywordflow">return</span> ts; }
<a name="l00064"></a>00064 };
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 }       <span class="comment">// end of xsens namespace</span>
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 <span class="preprocessor">#endif  // _XSENS_TIME_2006_09_12</span>
</pre></div>
<div class="tabs">&nbsp;</div>
<hr size="1" />
<address style="text-align: right;">
<small>Generated on 14 Nov 2008 for CMT by <a href="http://www.doxygen.org/index.html">Doxygen</a> 1.5.1-p1</small>
</address>
</body>
</html>
